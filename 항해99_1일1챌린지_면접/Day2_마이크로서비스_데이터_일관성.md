# 마이크로서비스 데이터 일관성

### 마이크로서비스 혹은 분산 시스템에서 데이터 일관성을 유지하기 위한 전략을 고민하거나 적용한 경험이 있다면 공유해주세요. 규모가 작아도 서비스 간 데이터 처리 흐름을 설계해본 경험이면 충분합니다.

> 단일 DB 트랜잭션이 아닌, 서비스 간 데이터 일관성을 유지하는 방식을 고민해본 경험을 떠올려 보세요. (예: Eventual Consistency, 이벤트 기반 처리, SAGA 패턴 등)

---

### 최종 답변

LLM을 이용한 챗봇 서비스에서 SAGA 패턴을 적용하여 데이터 일관성을 유지해본 경험이 있습니다.
유저가 질문을 보내면 백엔드에서 해당 유저의 토큰을 선차감한 뒤, 20초의 타입아웃을 설정하여 LLM 서버로 전달했습니다.
LLM 응답이 시간 내에 도착하지 않거나 오류가 발생하면 보상 트랜잭션을 통해 토큰을 자동 환급하고 사용자에게 실패 알림을 전송하도록 설계했습니다.

---

### 최초 답변

> 마이크로 서비스에서 django restframework를 통해서 프론트인 react로 데이터를 전달할 때 엔티티를 전달하지 않고 각각에 알맞는 DTO로 변환하여 데이터의 일관성을 유지하려고 노력했습니다.

-> 데이터 일관성을 유지했다고 보기 어려운 경험이다. -> 계층 간 데이터 캡슐화에 가까운 경험

질문의 핵심은 분산 트랜잭션의 전체적인 흐름 관리이다. 

여러 서비스 간의 작업을 조율하고 실패 시 일관성을 복구한 경험을 작성해야한다.

 
